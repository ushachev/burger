// const humbButton = document.querySelector(".humburger-menu-btn");
// const template = document.querySelector("#overlay-menu").innerHTML;
// const section = document.querySelector(".start");

// const overlayMenu = createMenu(template);

// // humbButton.addEventListener('click', function() {
// // 	overlayMenu.open();
// // 	this.classList.toggle('humburger-menu-btn_clicked');
// // });

// function createMenu(templateIn) {
// 	let tempBlock = document.createElement('div');

// 	tempBlock.innerHTML = templateIn;

// 	let closeElem = tempBlock.querySelector(".humburger-menu-btn");
// 	let menuElem = tempBlock.querySelector(".overlay-menu");

// 	tempBlock = null;

// 	menuElem.addEventListener('click', function(e) {
// 		let target = e.target;
// 		if (target.className === 'nav-menu__link') {
// 			closeElem.click();
// 		}
// 		if (target === menuElem) {
// 			closeElem.classList.toggle('humburger-menu-btn_clicked');
// 		}
// 	})

// 	closeElem.addEventListener('click', function() {
// 		section.removeChild(menuElem);
// 		humbButton.classList.toggle('humburger-menu-btn_clicked');
// 	})

// 	return {
// 		open() {
// 			section.appendChild(menuElem);
// 		}
// 	} 
// }
// ============================================

let overlay = (function(options) {
	let button = document.querySelector(options.button);
	let overlay = document.querySelector(options.overlay);
	let menuItems = overlay.querySelectorAll(".nav-menu__item");

	let counter = 0;

	let _menuAnimation = function() {
		menuItems[counter].classList.toggle("nav-menu__item_overlay");
		counter++;
		if (counter < menuItems.length) {
			setTimeout(_menuAnimation, 100);
		} else {
			counter = 0;
		}
		// (counter < menuItems.length) ? setTimeout(_menuAnimation, 100) : counter = 0;
	}

	let _toggleOverlay = function() {
		document.querySelector("body").classList.toggle("blocked");
		button.classList.toggle("humburger-menu-btn_clicked");
		overlay.classList.toggle("header_overlay");
		_menuAnimation();
	}

	let addListeners = function() {
		button.addEventListener('click', _toggleOverlay);
		overlay.addEventListener('click', function(e) {
			if (e.target.className === 'nav-menu__link' && 
				button.classList.contains("humburger-menu-btn_clicked")) {
				_toggleOverlay();
			}
		});
	}

	return {
		init: addListeners
	};
})({
	button: ".humburger-menu-btn",
	overlay: ".header"
})

overlay.init();

// ==============================

let accordeon = (function(options) {
	let accordBlock = document.querySelector(options.block);
	let isClicked = false;
	let isAnimOver = true;

	let _toggleAccordeon = function(elem) {
		if (isClicked) {
			let activeItem = accordBlock.querySelector("." + options.item);
			activeItem.classList.remove(options.item);
			activeItem.querySelector("." + options.content).style.height = 0;
		}
		elem.classList.toggle(options.item);
		let elemContent = elem.querySelector("." + options.content);
		elemContent.style.height = elemContent.scrollHeight + "px";
		isClicked = true;
	}

	let addListener = function() {
		accordBlock.addEventListener('click', function(e) {
			let itemClicked = e.target.parentElement;
			let isTrigger = (e.target.className === options.trigger);
			if (isTrigger && isAnimOver
				&& itemClicked.classList.contains(options.item)) {
					itemClicked.classList.remove(options.item);
					itemClicked.querySelector("." + options.content).style.height = 0;
					isClicked = false;
					isAnimOver = false;
					setTimeout(function() {isAnimOver = true;}, 600);
			} else if (isTrigger && isAnimOver) {
				_toggleAccordeon(itemClicked);
				isAnimOver = false;
				setTimeout(function() {isAnimOver = true;}, 600);
			}
		})
	}

	return {
		init: addListener
	};
})({
	block: ".accordeon",
	trigger: "accordeon__item-title",
	item: "accordeon__item_active",
	content: "accordeon__content"
})

accordeon.init();

// ======================================

let accordeonHor = (function(options) {
	let accordBlock = document.querySelector(options.block);
	let triggerWidth;
	let isClicked = false;
	let isPhone = window.innerWidth <= 480;
	if (isPhone) {
		accordBlock.style.left = accordBlock.getBoundingClientRect().left + 'px';
	}

	let _widthContent = function() {
		let itemQuantity = 3;
		if (isPhone) {itemQuantity = 1;}
		let computedWidth = window.innerWidth - itemQuantity * triggerWidth;

		return computedWidth > 540 ? 540 : computedWidth;
	}

	let _toggleAccordeon = function(elem) {
		let initialLeft = window.innerWidth - 3 * triggerWidth + 'px';
		if (isClicked) {
			let isOpenedItemClicked = elem.classList.contains(options.item);
			let activeItem = accordBlock.querySelector("." + options.item);
			activeItem.classList.toggle(options.item);
			activeItem.querySelector('.' + options.content).style.width = 0;
			isClicked = false;
			if (isOpenedItemClicked) {
				if (isPhone) {
					accordBlock.style.left = initialLeft;}
				return;
			}
		}
		elem.classList.toggle(options.item);
		let elemContent = elem.querySelector('.' + options.content);
		elemContent.style.width = _widthContent() + 'px';
		if (isPhone) {
			accordBlock.style.left = [].indexOf.call(accordBlock.children, elem) * 
			-(triggerWidth) + 'px';
		}
		isClicked = true;
	}

	let addListeners = function() {
		accordBlock.addEventListener('click', function(e) {
			let target = e.target.closest('.' + options.trigger);
			isPhone = window.innerWidth <= 480;
			triggerWidth = parseInt(getComputedStyle(accordBlock
				.querySelector('.' + options.trigger)).width);
			if (target) {
				_toggleAccordeon(target.parentElement);}
		})

		let crosses = accordBlock.querySelectorAll('.accordeon-hor__btn-close');
		for (let i = 0; i < crosses.length; i++) {
			crosses[i].addEventListener('click', function(e) {
			_toggleAccordeon(crosses[i].closest('.' + options.item))
		})
		}
		
	}

	return {init: addListeners};
})({
	block: ".accordeon-hor",
	trigger: "accordeon-hor__title",
	item: "accordeon-hor__item_active",
	content: "accordeon-hor__container"
})

accordeonHor.init();

// =====================================================

const moreButtons = document.querySelectorAll(".review__more-btn");
const templateRev = document.querySelector("#overlay-review").innerHTML;
const sectionRev = document.querySelector(".review");

const overlayReview = createReview(templateRev);

for (var i = 0; i < moreButtons.length; i++) {
	moreButtons[i].addEventListener('click', function(e) {
		let target = e.target.closest(".review__more-btn");
		if (target) {
			document.querySelector("body").classList.toggle("blocked");
			overlayReview.open(target.parentElement);
		}
	})
}

function createReview(templateIn) {
	let tempBlock = document.createElement('div');

	tempBlock.innerHTML = templateIn;

	let closeElem = tempBlock.querySelector(".overlay-review__btn-close");
	let overlayElem = tempBlock.querySelector(".overlay-review");
	let authorElem = tempBlock.querySelector(".overlay-review__title");
	let textElem = tempBlock.querySelector(".overlay-review__text");

	tempBlock = null;

	overlayElem.addEventListener('click', function(e) {
		if (e.target === overlayElem) {
			closeElem.click();
		}
	})

	closeElem.addEventListener('click', function() {
		document.querySelector("body").classList.toggle("blocked");
		sectionRev.removeChild(overlayElem);
	})

	return {
		open(item) {
			sectionRev.appendChild(overlayElem);
			authorElem.innerHTML = item.querySelector(".review__author").innerHTML;
			textElem.innerHTML = item.querySelector(".review__text").innerHTML;
		}
	}
}

// ==============================================

const owlBurger = $('.owl-carousel');

$(document).ready(function(){
	owlBurger.owlCarousel({
		loop: true,
		items: 1
	});
});

$('.burgers__prev').click(function() {
    owlBurger.trigger('prev.owl.carousel');
})

$('.burgers__next').click(function() {
    owlBurger.trigger('next.owl.carousel');
})

// =============================================

$(".main").onepage_scroll({
   sectionContainer: "section",     // sectionContainer accepts any kind of selector in case you don't want to use section
   easing: "ease",                  // Easing options accepts the CSS3 easing animation such "ease", "linear", "ease-in",
                                    // "ease-out", "ease-in-out", or even cubic bezier value such as "cubic-bezier(0.175, 0.885, 0.420, 1.310)"
   animationTime: 1000,             // AnimationTime let you define how long each section takes to animate
   pagination: false,                // You can either show or hide the pagination. Toggle true for show, false for hide.
   updateURL: false,                // Toggle this true if you want the URL to be updated automatically when the user scroll to each page.
   beforeMove: function(index) {},  // This option accepts a callback function. The function will be called before the page moves.
   afterMove: function(index) {},   // This option accepts a callback function. The function will be called after the page moves.
   loop: false,                     // You can have the page loop back to the top/bottom when the user navigates at up/down on the first/last page.
   keyboard: true,                  // You can activate the keyboard controls
   responsiveFallback: false,        // You can fallback to normal page scroll by defining the width of the browser in which
                                    // you want the responsive fallback to be triggered. For example, set this to 600 and whenever
                                    // the browser's width is less than 600, the fallback will kick in.
   direction: "vertical"            // You can now define the direction of the One Page Scroll animation. Options available are "vertical" and "horizontal". The default value is "vertical".  
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gY29uc3QgaHVtYkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaHVtYnVyZ2VyLW1lbnUtYnRuXCIpO1xyXG4vLyBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3ZlcmxheS1tZW51XCIpLmlubmVySFRNTDtcclxuLy8gY29uc3Qgc2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3RhcnRcIik7XHJcblxyXG4vLyBjb25zdCBvdmVybGF5TWVudSA9IGNyZWF0ZU1lbnUodGVtcGxhdGUpO1xyXG5cclxuLy8gLy8gaHVtYkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4vLyAvLyBcdG92ZXJsYXlNZW51Lm9wZW4oKTtcclxuLy8gLy8gXHR0aGlzLmNsYXNzTGlzdC50b2dnbGUoJ2h1bWJ1cmdlci1tZW51LWJ0bl9jbGlja2VkJyk7XHJcbi8vIC8vIH0pO1xyXG5cclxuLy8gZnVuY3Rpb24gY3JlYXRlTWVudSh0ZW1wbGF0ZUluKSB7XHJcbi8vIFx0bGV0IHRlbXBCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cclxuLy8gXHR0ZW1wQmxvY2suaW5uZXJIVE1MID0gdGVtcGxhdGVJbjtcclxuXHJcbi8vIFx0bGV0IGNsb3NlRWxlbSA9IHRlbXBCbG9jay5xdWVyeVNlbGVjdG9yKFwiLmh1bWJ1cmdlci1tZW51LWJ0blwiKTtcclxuLy8gXHRsZXQgbWVudUVsZW0gPSB0ZW1wQmxvY2sucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5LW1lbnVcIik7XHJcblxyXG4vLyBcdHRlbXBCbG9jayA9IG51bGw7XHJcblxyXG4vLyBcdG1lbnVFbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4vLyBcdFx0bGV0IHRhcmdldCA9IGUudGFyZ2V0O1xyXG4vLyBcdFx0aWYgKHRhcmdldC5jbGFzc05hbWUgPT09ICduYXYtbWVudV9fbGluaycpIHtcclxuLy8gXHRcdFx0Y2xvc2VFbGVtLmNsaWNrKCk7XHJcbi8vIFx0XHR9XHJcbi8vIFx0XHRpZiAodGFyZ2V0ID09PSBtZW51RWxlbSkge1xyXG4vLyBcdFx0XHRjbG9zZUVsZW0uY2xhc3NMaXN0LnRvZ2dsZSgnaHVtYnVyZ2VyLW1lbnUtYnRuX2NsaWNrZWQnKTtcclxuLy8gXHRcdH1cclxuLy8gXHR9KVxyXG5cclxuLy8gXHRjbG9zZUVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuLy8gXHRcdHNlY3Rpb24ucmVtb3ZlQ2hpbGQobWVudUVsZW0pO1xyXG4vLyBcdFx0aHVtYkJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdodW1idXJnZXItbWVudS1idG5fY2xpY2tlZCcpO1xyXG4vLyBcdH0pXHJcblxyXG4vLyBcdHJldHVybiB7XHJcbi8vIFx0XHRvcGVuKCkge1xyXG4vLyBcdFx0XHRzZWN0aW9uLmFwcGVuZENoaWxkKG1lbnVFbGVtKTtcclxuLy8gXHRcdH1cclxuLy8gXHR9IFxyXG4vLyB9XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5sZXQgb3ZlcmxheSA9IChmdW5jdGlvbihvcHRpb25zKSB7XHJcblx0bGV0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9ucy5idXR0b24pO1xyXG5cdGxldCBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb25zLm92ZXJsYXkpO1xyXG5cdGxldCBtZW51SXRlbXMgPSBvdmVybGF5LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubmF2LW1lbnVfX2l0ZW1cIik7XHJcblxyXG5cdGxldCBjb3VudGVyID0gMDtcclxuXHJcblx0bGV0IF9tZW51QW5pbWF0aW9uID0gZnVuY3Rpb24oKSB7XHJcblx0XHRtZW51SXRlbXNbY291bnRlcl0uY2xhc3NMaXN0LnRvZ2dsZShcIm5hdi1tZW51X19pdGVtX292ZXJsYXlcIik7XHJcblx0XHRjb3VudGVyKys7XHJcblx0XHRpZiAoY291bnRlciA8IG1lbnVJdGVtcy5sZW5ndGgpIHtcclxuXHRcdFx0c2V0VGltZW91dChfbWVudUFuaW1hdGlvbiwgMTAwKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGNvdW50ZXIgPSAwO1xyXG5cdFx0fVxyXG5cdFx0Ly8gKGNvdW50ZXIgPCBtZW51SXRlbXMubGVuZ3RoKSA/IHNldFRpbWVvdXQoX21lbnVBbmltYXRpb24sIDEwMCkgOiBjb3VudGVyID0gMDtcclxuXHR9XHJcblxyXG5cdGxldCBfdG9nZ2xlT3ZlcmxheSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIikuY2xhc3NMaXN0LnRvZ2dsZShcImJsb2NrZWRcIik7XHJcblx0XHRidXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImh1bWJ1cmdlci1tZW51LWJ0bl9jbGlja2VkXCIpO1xyXG5cdFx0b3ZlcmxheS5jbGFzc0xpc3QudG9nZ2xlKFwiaGVhZGVyX292ZXJsYXlcIik7XHJcblx0XHRfbWVudUFuaW1hdGlvbigpO1xyXG5cdH1cclxuXHJcblx0bGV0IGFkZExpc3RlbmVycyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0YnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3RvZ2dsZU92ZXJsYXkpO1xyXG5cdFx0b3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0aWYgKGUudGFyZ2V0LmNsYXNzTmFtZSA9PT0gJ25hdi1tZW51X19saW5rJyAmJiBcclxuXHRcdFx0XHRidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiaHVtYnVyZ2VyLW1lbnUtYnRuX2NsaWNrZWRcIikpIHtcclxuXHRcdFx0XHRfdG9nZ2xlT3ZlcmxheSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRpbml0OiBhZGRMaXN0ZW5lcnNcclxuXHR9O1xyXG59KSh7XHJcblx0YnV0dG9uOiBcIi5odW1idXJnZXItbWVudS1idG5cIixcclxuXHRvdmVybGF5OiBcIi5oZWFkZXJcIlxyXG59KVxyXG5cclxub3ZlcmxheS5pbml0KCk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmxldCBhY2NvcmRlb24gPSAoZnVuY3Rpb24ob3B0aW9ucykge1xyXG5cdGxldCBhY2NvcmRCbG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9ucy5ibG9jayk7XHJcblx0bGV0IGlzQ2xpY2tlZCA9IGZhbHNlO1xyXG5cdGxldCBpc0FuaW1PdmVyID0gdHJ1ZTtcclxuXHJcblx0bGV0IF90b2dnbGVBY2NvcmRlb24gPSBmdW5jdGlvbihlbGVtKSB7XHJcblx0XHRpZiAoaXNDbGlja2VkKSB7XHJcblx0XHRcdGxldCBhY3RpdmVJdGVtID0gYWNjb3JkQmxvY2sucXVlcnlTZWxlY3RvcihcIi5cIiArIG9wdGlvbnMuaXRlbSk7XHJcblx0XHRcdGFjdGl2ZUl0ZW0uY2xhc3NMaXN0LnJlbW92ZShvcHRpb25zLml0ZW0pO1xyXG5cdFx0XHRhY3RpdmVJdGVtLnF1ZXJ5U2VsZWN0b3IoXCIuXCIgKyBvcHRpb25zLmNvbnRlbnQpLnN0eWxlLmhlaWdodCA9IDA7XHJcblx0XHR9XHJcblx0XHRlbGVtLmNsYXNzTGlzdC50b2dnbGUob3B0aW9ucy5pdGVtKTtcclxuXHRcdGxldCBlbGVtQ29udGVudCA9IGVsZW0ucXVlcnlTZWxlY3RvcihcIi5cIiArIG9wdGlvbnMuY29udGVudCk7XHJcblx0XHRlbGVtQ29udGVudC5zdHlsZS5oZWlnaHQgPSBlbGVtQ29udGVudC5zY3JvbGxIZWlnaHQgKyBcInB4XCI7XHJcblx0XHRpc0NsaWNrZWQgPSB0cnVlO1xyXG5cdH1cclxuXHJcblx0bGV0IGFkZExpc3RlbmVyID0gZnVuY3Rpb24oKSB7XHJcblx0XHRhY2NvcmRCbG9jay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0bGV0IGl0ZW1DbGlja2VkID0gZS50YXJnZXQucGFyZW50RWxlbWVudDtcclxuXHRcdFx0bGV0IGlzVHJpZ2dlciA9IChlLnRhcmdldC5jbGFzc05hbWUgPT09IG9wdGlvbnMudHJpZ2dlcik7XHJcblx0XHRcdGlmIChpc1RyaWdnZXIgJiYgaXNBbmltT3ZlclxyXG5cdFx0XHRcdCYmIGl0ZW1DbGlja2VkLmNsYXNzTGlzdC5jb250YWlucyhvcHRpb25zLml0ZW0pKSB7XHJcblx0XHRcdFx0XHRpdGVtQ2xpY2tlZC5jbGFzc0xpc3QucmVtb3ZlKG9wdGlvbnMuaXRlbSk7XHJcblx0XHRcdFx0XHRpdGVtQ2xpY2tlZC5xdWVyeVNlbGVjdG9yKFwiLlwiICsgb3B0aW9ucy5jb250ZW50KS5zdHlsZS5oZWlnaHQgPSAwO1xyXG5cdFx0XHRcdFx0aXNDbGlja2VkID0gZmFsc2U7XHJcblx0XHRcdFx0XHRpc0FuaW1PdmVyID0gZmFsc2U7XHJcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge2lzQW5pbU92ZXIgPSB0cnVlO30sIDYwMCk7XHJcblx0XHRcdH0gZWxzZSBpZiAoaXNUcmlnZ2VyICYmIGlzQW5pbU92ZXIpIHtcclxuXHRcdFx0XHRfdG9nZ2xlQWNjb3JkZW9uKGl0ZW1DbGlja2VkKTtcclxuXHRcdFx0XHRpc0FuaW1PdmVyID0gZmFsc2U7XHJcblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtpc0FuaW1PdmVyID0gdHJ1ZTt9LCA2MDApO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdH1cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGluaXQ6IGFkZExpc3RlbmVyXHJcblx0fTtcclxufSkoe1xyXG5cdGJsb2NrOiBcIi5hY2NvcmRlb25cIixcclxuXHR0cmlnZ2VyOiBcImFjY29yZGVvbl9faXRlbS10aXRsZVwiLFxyXG5cdGl0ZW06IFwiYWNjb3JkZW9uX19pdGVtX2FjdGl2ZVwiLFxyXG5cdGNvbnRlbnQ6IFwiYWNjb3JkZW9uX19jb250ZW50XCJcclxufSlcclxuXHJcbmFjY29yZGVvbi5pbml0KCk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxubGV0IGFjY29yZGVvbkhvciA9IChmdW5jdGlvbihvcHRpb25zKSB7XHJcblx0bGV0IGFjY29yZEJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb25zLmJsb2NrKTtcclxuXHRsZXQgdHJpZ2dlcldpZHRoO1xyXG5cdGxldCBpc0NsaWNrZWQgPSBmYWxzZTtcclxuXHRsZXQgaXNQaG9uZSA9IHdpbmRvdy5pbm5lcldpZHRoIDw9IDQ4MDtcclxuXHRpZiAoaXNQaG9uZSkge1xyXG5cdFx0YWNjb3JkQmxvY2suc3R5bGUubGVmdCA9IGFjY29yZEJsb2NrLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgKyAncHgnO1xyXG5cdH1cclxuXHJcblx0bGV0IF93aWR0aENvbnRlbnQgPSBmdW5jdGlvbigpIHtcclxuXHRcdGxldCBpdGVtUXVhbnRpdHkgPSAzO1xyXG5cdFx0aWYgKGlzUGhvbmUpIHtpdGVtUXVhbnRpdHkgPSAxO31cclxuXHRcdGxldCBjb21wdXRlZFdpZHRoID0gd2luZG93LmlubmVyV2lkdGggLSBpdGVtUXVhbnRpdHkgKiB0cmlnZ2VyV2lkdGg7XHJcblxyXG5cdFx0cmV0dXJuIGNvbXB1dGVkV2lkdGggPiA1NDAgPyA1NDAgOiBjb21wdXRlZFdpZHRoO1xyXG5cdH1cclxuXHJcblx0bGV0IF90b2dnbGVBY2NvcmRlb24gPSBmdW5jdGlvbihlbGVtKSB7XHJcblx0XHRsZXQgaW5pdGlhbExlZnQgPSB3aW5kb3cuaW5uZXJXaWR0aCAtIDMgKiB0cmlnZ2VyV2lkdGggKyAncHgnO1xyXG5cdFx0aWYgKGlzQ2xpY2tlZCkge1xyXG5cdFx0XHRsZXQgaXNPcGVuZWRJdGVtQ2xpY2tlZCA9IGVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKG9wdGlvbnMuaXRlbSk7XHJcblx0XHRcdGxldCBhY3RpdmVJdGVtID0gYWNjb3JkQmxvY2sucXVlcnlTZWxlY3RvcihcIi5cIiArIG9wdGlvbnMuaXRlbSk7XHJcblx0XHRcdGFjdGl2ZUl0ZW0uY2xhc3NMaXN0LnRvZ2dsZShvcHRpb25zLml0ZW0pO1xyXG5cdFx0XHRhY3RpdmVJdGVtLnF1ZXJ5U2VsZWN0b3IoJy4nICsgb3B0aW9ucy5jb250ZW50KS5zdHlsZS53aWR0aCA9IDA7XHJcblx0XHRcdGlzQ2xpY2tlZCA9IGZhbHNlO1xyXG5cdFx0XHRpZiAoaXNPcGVuZWRJdGVtQ2xpY2tlZCkge1xyXG5cdFx0XHRcdGlmIChpc1Bob25lKSB7XHJcblx0XHRcdFx0XHRhY2NvcmRCbG9jay5zdHlsZS5sZWZ0ID0gaW5pdGlhbExlZnQ7fVxyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxlbS5jbGFzc0xpc3QudG9nZ2xlKG9wdGlvbnMuaXRlbSk7XHJcblx0XHRsZXQgZWxlbUNvbnRlbnQgPSBlbGVtLnF1ZXJ5U2VsZWN0b3IoJy4nICsgb3B0aW9ucy5jb250ZW50KTtcclxuXHRcdGVsZW1Db250ZW50LnN0eWxlLndpZHRoID0gX3dpZHRoQ29udGVudCgpICsgJ3B4JztcclxuXHRcdGlmIChpc1Bob25lKSB7XHJcblx0XHRcdGFjY29yZEJsb2NrLnN0eWxlLmxlZnQgPSBbXS5pbmRleE9mLmNhbGwoYWNjb3JkQmxvY2suY2hpbGRyZW4sIGVsZW0pICogXHJcblx0XHRcdC0odHJpZ2dlcldpZHRoKSArICdweCc7XHJcblx0XHR9XHJcblx0XHRpc0NsaWNrZWQgPSB0cnVlO1xyXG5cdH1cclxuXHJcblx0bGV0IGFkZExpc3RlbmVycyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0YWNjb3JkQmxvY2suYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcblx0XHRcdGxldCB0YXJnZXQgPSBlLnRhcmdldC5jbG9zZXN0KCcuJyArIG9wdGlvbnMudHJpZ2dlcik7XHJcblx0XHRcdGlzUGhvbmUgPSB3aW5kb3cuaW5uZXJXaWR0aCA8PSA0ODA7XHJcblx0XHRcdHRyaWdnZXJXaWR0aCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUoYWNjb3JkQmxvY2tcclxuXHRcdFx0XHQucXVlcnlTZWxlY3RvcignLicgKyBvcHRpb25zLnRyaWdnZXIpKS53aWR0aCk7XHJcblx0XHRcdGlmICh0YXJnZXQpIHtcclxuXHRcdFx0XHRfdG9nZ2xlQWNjb3JkZW9uKHRhcmdldC5wYXJlbnRFbGVtZW50KTt9XHJcblx0XHR9KVxyXG5cclxuXHRcdGxldCBjcm9zc2VzID0gYWNjb3JkQmxvY2sucXVlcnlTZWxlY3RvckFsbCgnLmFjY29yZGVvbi1ob3JfX2J0bi1jbG9zZScpO1xyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjcm9zc2VzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGNyb3NzZXNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcblx0XHRcdF90b2dnbGVBY2NvcmRlb24oY3Jvc3Nlc1tpXS5jbG9zZXN0KCcuJyArIG9wdGlvbnMuaXRlbSkpXHJcblx0XHR9KVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge2luaXQ6IGFkZExpc3RlbmVyc307XHJcbn0pKHtcclxuXHRibG9jazogXCIuYWNjb3JkZW9uLWhvclwiLFxyXG5cdHRyaWdnZXI6IFwiYWNjb3JkZW9uLWhvcl9fdGl0bGVcIixcclxuXHRpdGVtOiBcImFjY29yZGVvbi1ob3JfX2l0ZW1fYWN0aXZlXCIsXHJcblx0Y29udGVudDogXCJhY2NvcmRlb24taG9yX19jb250YWluZXJcIlxyXG59KVxyXG5cclxuYWNjb3JkZW9uSG9yLmluaXQoKTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5jb25zdCBtb3JlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmV2aWV3X19tb3JlLWJ0blwiKTtcclxuY29uc3QgdGVtcGxhdGVSZXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI292ZXJsYXktcmV2aWV3XCIpLmlubmVySFRNTDtcclxuY29uc3Qgc2VjdGlvblJldiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2aWV3XCIpO1xyXG5cclxuY29uc3Qgb3ZlcmxheVJldmlldyA9IGNyZWF0ZVJldmlldyh0ZW1wbGF0ZVJldik7XHJcblxyXG5mb3IgKHZhciBpID0gMDsgaSA8IG1vcmVCdXR0b25zLmxlbmd0aDsgaSsrKSB7XHJcblx0bW9yZUJ1dHRvbnNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcblx0XHRsZXQgdGFyZ2V0ID0gZS50YXJnZXQuY2xvc2VzdChcIi5yZXZpZXdfX21vcmUtYnRuXCIpO1xyXG5cdFx0aWYgKHRhcmdldCkge1xyXG5cdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKS5jbGFzc0xpc3QudG9nZ2xlKFwiYmxvY2tlZFwiKTtcclxuXHRcdFx0b3ZlcmxheVJldmlldy5vcGVuKHRhcmdldC5wYXJlbnRFbGVtZW50KTtcclxuXHRcdH1cclxuXHR9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVSZXZpZXcodGVtcGxhdGVJbikge1xyXG5cdGxldCB0ZW1wQmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHJcblx0dGVtcEJsb2NrLmlubmVySFRNTCA9IHRlbXBsYXRlSW47XHJcblxyXG5cdGxldCBjbG9zZUVsZW0gPSB0ZW1wQmxvY2sucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5LXJldmlld19fYnRuLWNsb3NlXCIpO1xyXG5cdGxldCBvdmVybGF5RWxlbSA9IHRlbXBCbG9jay5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXktcmV2aWV3XCIpO1xyXG5cdGxldCBhdXRob3JFbGVtID0gdGVtcEJsb2NrLnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheS1yZXZpZXdfX3RpdGxlXCIpO1xyXG5cdGxldCB0ZXh0RWxlbSA9IHRlbXBCbG9jay5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXktcmV2aWV3X190ZXh0XCIpO1xyXG5cclxuXHR0ZW1wQmxvY2sgPSBudWxsO1xyXG5cclxuXHRvdmVybGF5RWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdGlmIChlLnRhcmdldCA9PT0gb3ZlcmxheUVsZW0pIHtcclxuXHRcdFx0Y2xvc2VFbGVtLmNsaWNrKCk7XHJcblx0XHR9XHJcblx0fSlcclxuXHJcblx0Y2xvc2VFbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKS5jbGFzc0xpc3QudG9nZ2xlKFwiYmxvY2tlZFwiKTtcclxuXHRcdHNlY3Rpb25SZXYucmVtb3ZlQ2hpbGQob3ZlcmxheUVsZW0pO1xyXG5cdH0pXHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRvcGVuKGl0ZW0pIHtcclxuXHRcdFx0c2VjdGlvblJldi5hcHBlbmRDaGlsZChvdmVybGF5RWxlbSk7XHJcblx0XHRcdGF1dGhvckVsZW0uaW5uZXJIVE1MID0gaXRlbS5xdWVyeVNlbGVjdG9yKFwiLnJldmlld19fYXV0aG9yXCIpLmlubmVySFRNTDtcclxuXHRcdFx0dGV4dEVsZW0uaW5uZXJIVE1MID0gaXRlbS5xdWVyeVNlbGVjdG9yKFwiLnJldmlld19fdGV4dFwiKS5pbm5lckhUTUw7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5jb25zdCBvd2xCdXJnZXIgPSAkKCcub3dsLWNhcm91c2VsJyk7XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe1xyXG5cdG93bEJ1cmdlci5vd2xDYXJvdXNlbCh7XHJcblx0XHRsb29wOiB0cnVlLFxyXG5cdFx0aXRlbXM6IDFcclxuXHR9KTtcclxufSk7XHJcblxyXG4kKCcuYnVyZ2Vyc19fcHJldicpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgb3dsQnVyZ2VyLnRyaWdnZXIoJ3ByZXYub3dsLmNhcm91c2VsJyk7XHJcbn0pXHJcblxyXG4kKCcuYnVyZ2Vyc19fbmV4dCcpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgb3dsQnVyZ2VyLnRyaWdnZXIoJ25leHQub3dsLmNhcm91c2VsJyk7XHJcbn0pXHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiQoXCIubWFpblwiKS5vbmVwYWdlX3Njcm9sbCh7XHJcbiAgIHNlY3Rpb25Db250YWluZXI6IFwic2VjdGlvblwiLCAgICAgLy8gc2VjdGlvbkNvbnRhaW5lciBhY2NlcHRzIGFueSBraW5kIG9mIHNlbGVjdG9yIGluIGNhc2UgeW91IGRvbid0IHdhbnQgdG8gdXNlIHNlY3Rpb25cclxuICAgZWFzaW5nOiBcImVhc2VcIiwgICAgICAgICAgICAgICAgICAvLyBFYXNpbmcgb3B0aW9ucyBhY2NlcHRzIHRoZSBDU1MzIGVhc2luZyBhbmltYXRpb24gc3VjaCBcImVhc2VcIiwgXCJsaW5lYXJcIiwgXCJlYXNlLWluXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFwiZWFzZS1vdXRcIiwgXCJlYXNlLWluLW91dFwiLCBvciBldmVuIGN1YmljIGJlemllciB2YWx1ZSBzdWNoIGFzIFwiY3ViaWMtYmV6aWVyKDAuMTc1LCAwLjg4NSwgMC40MjAsIDEuMzEwKVwiXHJcbiAgIGFuaW1hdGlvblRpbWU6IDEwMDAsICAgICAgICAgICAgIC8vIEFuaW1hdGlvblRpbWUgbGV0IHlvdSBkZWZpbmUgaG93IGxvbmcgZWFjaCBzZWN0aW9uIHRha2VzIHRvIGFuaW1hdGVcclxuICAgcGFnaW5hdGlvbjogdHJ1ZSwgICAgICAgICAgICAgICAgLy8gWW91IGNhbiBlaXRoZXIgc2hvdyBvciBoaWRlIHRoZSBwYWdpbmF0aW9uLiBUb2dnbGUgdHJ1ZSBmb3Igc2hvdywgZmFsc2UgZm9yIGhpZGUuXHJcbiAgIHVwZGF0ZVVSTDogZmFsc2UsICAgICAgICAgICAgICAgIC8vIFRvZ2dsZSB0aGlzIHRydWUgaWYgeW91IHdhbnQgdGhlIFVSTCB0byBiZSB1cGRhdGVkIGF1dG9tYXRpY2FsbHkgd2hlbiB0aGUgdXNlciBzY3JvbGwgdG8gZWFjaCBwYWdlLlxyXG4gICBiZWZvcmVNb3ZlOiBmdW5jdGlvbihpbmRleCkge30sICAvLyBUaGlzIG9wdGlvbiBhY2NlcHRzIGEgY2FsbGJhY2sgZnVuY3Rpb24uIFRoZSBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCBiZWZvcmUgdGhlIHBhZ2UgbW92ZXMuXHJcbiAgIGFmdGVyTW92ZTogZnVuY3Rpb24oaW5kZXgpIHt9LCAgIC8vIFRoaXMgb3B0aW9uIGFjY2VwdHMgYSBjYWxsYmFjayBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIHRoZSBwYWdlIG1vdmVzLlxyXG4gICBsb29wOiBmYWxzZSwgICAgICAgICAgICAgICAgICAgICAvLyBZb3UgY2FuIGhhdmUgdGhlIHBhZ2UgbG9vcCBiYWNrIHRvIHRoZSB0b3AvYm90dG9tIHdoZW4gdGhlIHVzZXIgbmF2aWdhdGVzIGF0IHVwL2Rvd24gb24gdGhlIGZpcnN0L2xhc3QgcGFnZS5cclxuICAga2V5Ym9hcmQ6IHRydWUsICAgICAgICAgICAgICAgICAgLy8gWW91IGNhbiBhY3RpdmF0ZSB0aGUga2V5Ym9hcmQgY29udHJvbHNcclxuICAgcmVzcG9uc2l2ZUZhbGxiYWNrOiBmYWxzZSwgICAgICAgIC8vIFlvdSBjYW4gZmFsbGJhY2sgdG8gbm9ybWFsIHBhZ2Ugc2Nyb2xsIGJ5IGRlZmluaW5nIHRoZSB3aWR0aCBvZiB0aGUgYnJvd3NlciBpbiB3aGljaFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB5b3Ugd2FudCB0aGUgcmVzcG9uc2l2ZSBmYWxsYmFjayB0byBiZSB0cmlnZ2VyZWQuIEZvciBleGFtcGxlLCBzZXQgdGhpcyB0byA2MDAgYW5kIHdoZW5ldmVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBicm93c2VyJ3Mgd2lkdGggaXMgbGVzcyB0aGFuIDYwMCwgdGhlIGZhbGxiYWNrIHdpbGwga2ljayBpbi5cclxuICAgZGlyZWN0aW9uOiBcInZlcnRpY2FsXCIgICAgICAgICAgICAvLyBZb3UgY2FuIG5vdyBkZWZpbmUgdGhlIGRpcmVjdGlvbiBvZiB0aGUgT25lIFBhZ2UgU2Nyb2xsIGFuaW1hdGlvbi4gT3B0aW9ucyBhdmFpbGFibGUgYXJlIFwidmVydGljYWxcIiBhbmQgXCJob3Jpem9udGFsXCIuIFRoZSBkZWZhdWx0IHZhbHVlIGlzIFwidmVydGljYWxcIi4gIFxyXG59KTsiXX0=
